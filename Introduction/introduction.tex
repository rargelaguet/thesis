\chapter{Introduction}

\section{Multi-omics at single cell resolution}

Next-generation sequencing technologies have revolutionised the study of biological systems by enabling the genome-wide profiling of molecular layers in un unbiased manner, including the genome\cite{Fleischmann1995} the epigenome\cite{Frommer1992} and the transcriptome\cite{Lister2008,Bainbridge2006,Nagalakshmi2008,Mortazavi2008}, among others. However, bulk sequencing approaches rely on the pool of large number of cells to report an average molecular readout, and are hence limited for the study of complex biological processes where heterogeneity is expected at single cell resolution \cite{Griffiths2018,Papalexi2017,Patel2014}. \\
The progressive development of low-input sequencing techniques resulted in an explosion of single-cell sequencing technologies, mostly for the transcriptome. In contrast to bulk protocols, single-cell techniques provide an unprecedented opportunity to study the molecular variation associated with cellular heterogeneity, lineage diversification and cell fate commitment \cite{Kolodziejczyk2015}.

The field of single-cell sequencing has largely been driven by the quantification of the messenger RNA (mRNA). In less than a decade, the field of single-cell transcriptomics has experienced an exponential growth of scale, driven by incremental optimisations of reagent volumes and consumable costs, as well as profound changes in the nature of the technology \cite{Svensson2019}. The earliest high-throughput scRNA-seq technologies were published between 2009 and 2011, yielding a handful of cells. In 2019, there are studies that have achieved the astonishing milestone of profiling the transcriptome for more than a million cells in a single experiment \cite{Cao2019}. With the development of efficient commercial platforms, the maturation of scRNA-sequencing technologies has provided major insights on the study of lineage diversification and cell fate commitment \cite{Kolodziejczyk2015,Griffiths2018,Papalexi2017,Patel2014}. In 2020, we are at the stage of a major endeavour to generate transcriptomic atlases for different tissues, embryos and even entire adult organisms. The most ambitious of all is the Human Cell Atlas, aimed at building a reference map for all cells in the human body\cite{Aviv2017}.

While the large majority of single-cell studies are focused on capturing RNA expression information, transcriptomic readouts provide a single dimension of cellular heterogeneity and hence contain limited information to characterise the molecular determinants of phenotypic variation \cite{Ritchie2015}. Consequently, gene expression markers have been identified for a myriad of biological systems, but the role of the accompanying epigenetic changes in driving cell fate decisions remains poorly understood \cite{Griffiths2018,Kelsey2017,Bheda2014}.

To get a better insight into the epigenetics of cell fate commitment, significant effort has been placed to obtain epigenetic measurements at single-cell resolution by adapting bulk methods to low-input material. This has been particularly successful for chromatin accessibility. Due to its cost-effective strategy, single-cell ATAC-seq (scATAC-seq) has become the most popular technique to map open chromatin, and is also available in an efficient commercial platform. \cite{Cusanovich2015,Cao2018,Chen2018}.\\
Other molecular layers have also been queried through the lens of single cells, including DNA methylation\cite{Smallwood2014}, histone modifications \cite{Ku2019}, chromatin conformation \cite{Ku2019}, proteomics \cite{Specht2018} and lipidomics \cite{Thiele2019}.

Despite is profuse success in studying molecular variation, no single "-omics" technology can capture the intricacy of complex biological mechanisms. Nonetheless, the collective information has the potential to draw a more comprehensive picture of biological processes \cite{Hasin2017,Ritchie2015}. In particular, multi-omics (or multi-modal) assays have the potential to go beyond snapshots and provide a more dynamic, perhaps even mechanistic, understanding of the connection between molecular layers. Motivated by this, multi-omic data sets are receiving increasing interest across a wide range of biological domains, including cancer biology \cite{Akavia2010,Gerstung2015}, regulatory genomics \cite{Chen2016}, microbiology \cite{Kim2016} or host-pathogen interactions \cite{Soderholm2016}. 

The profiling of multi-omic readouts at the bulk level is relatively simple, as the same tissue can be dissociated into different aliquots, where each assay can be performed independently \cite{Ritchie2015}. This strategy is also used with single-cell assays, but it has the important downside that the different molecular layers cannot be unambiguously linked, hence limiting the insights that can be inferred from the data. The ultimate goal in single-cell sequencing is to obtain different molecular readouts from the same cell.

Multi-modal measurements at single-cell resolution can be obtained using a variety of strategies, some of which will be discussed in this thesis. The development of these technologies will help us understand the fundamental regulatory principles that connect the different molecular layers. In addition, integrative analyses that simultaneously pool information across multiple data modalities (-omics) and across multiple studies promise to deliver a more comprehensive insights into the complex variation that underlie cellular populations \cite{Stuart2019,Colome-Tatche2018}.

Notably, the early success and rapid development of single-cell multi-modal methods has led to their recognition as Method of the year in 2019 by the journal \textit{Nature Methods}. However, their development is still in pilot stages and there is no commercial platform available, limiting its widespread use by the community. Furthermore, common challenges in (uni-modal) single-cell assays such as low coverage and high levels of technical noise become exacerbated when doing multi-modal profiling. Quoting a befitting sentence from Cole Trapnell, one of the pioneers of single-cell data analysis: \textit{When you do a multi-omic assay, you're combining all the bad things from multiple protocols}. Thus, one of the biggest challenge in integrative multi-modal analysis is to develop statistical frameworks that are capable of uncovering biological signal across multiple data modalities while overcoming all the technical biases and missing information that are inherent to single-cell experiments. 


\section{Integrative analysis of multi-modal assays}

From the computational perspective, the rapid development of single-cell technologies is introducing unprecedented challenges for the statistical community, and novel computational methods need to be developed (or adapted) for interrogating the data generated \cite{Stegle2015}.\\
The vast majority of methods for single-cell data analysis are focused on scRNA-seq. These include normalisation\cite{Lun2018}, feature selection\cite{Townes2019}, differential expression \cite{Kharchenko2014}, clustering\cite{Kiselev2017}, cell type recognition \cite{Abdelaal2019}, pseudotime inference \cite{Haghverdi2016}, detection of gene regulatory networks and batch correction \cite{Haghverdi2018}, among others. Analysis tools have been wrapped into popular platforms such as Seurat \cite{Butler2018}, Scater \cite{McCarthy2017} and Scanpy \cite{Wolf2018}.\\
Despite the explosion of statistical methods for scRNA-seq data analysis, to date very few methods have been published  with the aim to perform data integration of single-cell multi-modal assays. This is probably due to the lack of large-scale data sets to apply and benchmark methods. But also, given the high levels of missing information, the inherent amounts of technical noise and the potentially large number of cells, the integrative analysis of multi-modal measurements is arguably one of the most challenging problems in single-cell biology.

The first step when performing data integration is to consider (or not) a common coordinate framework to anchor the different data modalities. This defines three broad types of strategies for single-cell data integration: 

\begin{itemize}

	\item Samples are the common coordinate framework: when the different data modalities are derived from the same cell. We call this \textit{matched} multi-omics and the main advantage is that here unambiguous assignment between the molecular profiles. Nevertheless, as mentioned above, such assays are difficult, expensive and currently less adopted by the community. In this case, the aim of the computational strategies is to distinguish the axis of cell-to-cell heterogeneity that are coordinated versus the variation that is uncoordinated across molecular layers.

	\item Genomic features are the common coordinate framework: when the different data modalities are not derived from the same cell. We call this \textit{non-matched} multi-omics and the main advantage is that it is significantly easier and cheaper to obtain, and as a result most of the data sets to date belong to this category. In this case, the aim of computational strategies is generally to find a common manifold and identify cell anchors between the two modalities. An example of this type of data integration is when having scRNA-seq and scATAC-seq experiments from different sets of cells. Genes can be defined as the common coordinate framework by quantifying mRNA expression and summarising chromatin accessibility at the gene promoter or gene body level.

	\item No common coordinate framework (in the high-dimensional space): when the different data modalities are not anchored by any of the two axis in the high-dimensional space (i.e. cells or genes). In this scenario, methods could exploit the assumption of a common manifold in a potential \textit{low-dimensional} space, for example when cells are sampled from the same differentiation trajectory. In the general and multivariate case, this is arguably the most complex data integration task and, to my current knowledge, no convincing and principled methods have been published to date.

\end{itemize}

Once the common coordinate framework is defined, the actual data integration strategy can be classified into two classes that can be categorised as \textit{local} and \textit{global}. This notation is inspired from integrative approaches that have been pursuit over the last years at the bulk level\cite{Ritchie2015}, but this classification remains applicable to the single-cell domain. In fact, as we shall demonstrate in this thesis, some methods designed for bulk data sets can be applicable to single-cell data with minor modifications.\\
Local analysis refers to the study of hierarchical associations between individual features from different molecular layers. Prominent examples are genome-wide association studies (GWAS) in combination with expression quantitative trait loci (eQTL), methylation QTLs or protein QTLs \cite{VanDerWijst2018,Chen2016,Pierce2018,Bonder2016}. While eminently useful for characterising genetic variants, such association studies are inherently local and have a limited capacity to discover global maps of molecular heterogeneity that typically result from complex interactions between features. In addition, such approaches are challenging in the multi-omics setting due to the massive multiple testing problem \cite{Sul2015}.\\
Global analysis on the other hand try to extract patterns from the full data set. This can be done by direct concatenation of all data modalities followed by the use of traditional statistical methods. Additional alternatives have been proposed that perform transformations on each data type before merging them into a common similarity network, e.g. using kernel or graph-based approaches \cite{Lanckriet2004, Wang2014}. Nonetheless, both of these approaches entail important setbacks that will be discussed and addressed in this thesis.

\section{Thesis overview}

In this PhD thesis I sought to develop computational strategies for data integration using single-cell multi-omics data. In particular my research focued on the \textit{matched} case, when cells are the common coordinate framework.

In Chapter 1 I introduce single-cell nucleosome, methylation and transcription sequencing (scNMT-seq), an experimental protocol for the genome-wide profiling of RNA expression, DNA methylation and chromatin accessibility in single cells. While some approaches have reported unbiased genome-wide measurements of up to two molecular layers, scNMT-seq allows, for the first time, the simultaneous profiling of three molecular layers at single cell resolution. We validate the readouts using a simple prototypic experiment, and we show how scNMT-seq can be used to study coordinated epigenetic and transcriptomic heterogeneity along a simple differentiation process.

In Chapter 2 I present Multi-Omics Factor Analysis (MOFA), a statistical framework for the integration of multi-omics data sets. MOFA is a latent variable model that offers a principled approach to explore, in a completely unsupervised manner, the underlying sources of sample heterogeneity in a multi-omics data set. Once the model is trained, the inferred low-dimensional space can be interpreted using a tool-kit of downstream analysis that include multiple visualisations, clustering, imputation or prediction of clinical outcomes. First, we validate the different model features using simulated data. Second, we apply MOFA to a multi-omics study of 200 chronic lymphocytic leukaemia patients. In a quick unsupervised analysis, MOFA revealed the most important dimensions of disease heterogeneity, connected to clinical markers that are commonly used in practice. In a second application we show how MOFA can cope with noisy single-cell multi-modal data, identifying coordinated transcriptional and epigenetic changes along a differentiation process.

In Chapter 3 I discuss how we combined scNMT-seq and MOFA to study the role of epigenetic layers during mouse gastrulation, a critical embryonic stage that spans exit from pluripotency to primary germ layer specification. In this study we built the first triple-omics roadmap of mouse gastrulation, which enabled us to perform an integrative study that revealed novel insights on the dynamics of the epigenome. Notably, we show that cells committed to mesoderm and endoderm undergo widespread epigenetic rearrangements, driven by demethylation in enhancer marks and by concerted changes in chromatin accessibility. In contrast, the epigenetic landscape of ectoderm cells remains in a \textit{default} state, resembling earlier stage epiblast cells is epigenetically established in the early epiblast. This work provides a comprehensive insight into the molecular logic for a hierarchical emergence of the primary germ layers, revealing underlying molecular constituents of the Waddington's landscape.

In Chapter 4 I propose an improved formulation of the MOFA framework presented in Chapter 2 with the aim of performing integrative analysis of large-scale (single-cell) data sets across multiple studies/conditions as well as data modalities. To tailor MOFA to the statistical challenges of single-cell data, we introduce key methodological developments, including a fast stochastic variational inference framework and multi-group generalisation in the structure of the prior distributions. All together, this allows MOFA to  disentangle heterogeneity across sample groups (i.e. studies or experimental conditions) and data modalities (i.e. omics) in very large single-cell studies. First, we benchmark the new features of the model using simulated data. Next, we use a single-cell DNA methylation data set of neurons from mouse frontal cortex to demonstrate how from a seemingly unimodal data set, one can investigate hypothesis using a multi-group and multi-view setting. Finally, we apply MOFA to the scNMT-seq data set generated in Chapter 3, revealing underlying sources of molecular variation associated with early cell fate decisions.

Finally, Chapter 5 summarises this thesis and provides an outlook of future research.