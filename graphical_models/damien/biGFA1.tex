% model-binomial-probit.tex
%

% Augmented Binomial Probit regression model

%\beginpgfgraphicnamed{model-binomial-probit}

\input{graphical_models/colours}

\begin{tikzpicture}
  % Define nodes:
  % matrix factorisation level
  \node[obs]   (Y) {$y_{n,d}^{m,g}$};
  \node[latent, above=of Y, xshift=-1.5cm] (Z) {$z^g_{n,k}$};
  \node[latent, above=of Y, xshift=1.5cm] (W) {$w^m_{k,d}$};
  \node[latent, xshift=1.5cm] (Tau) {$\tau^m_{d}$};
  \node[latent, above=of W] (alpha) {$\alpha^m_{k}$};
  \node[latent, above=of Z] (alphaZ) {$\alpha^g_{k}$};

  % Connect the nodes
  \edge {Z,W, Tau} {Y}; %
  \edge {alpha} {W};
  \edge {alphaZ} {Z};

  % Plates
  \plate[] {plateK} {(Z)(W)(alpha)} {$K$};

  \plate[] {plateN} {(Y)(Z)(plateK.south west)} {$N_g$};
  \plate[] {plateG} {(plateK.north west)(plateN.south east)(plateN.south west)} {$G$};

  \plate[] {plateD} {(Y)(W)(Tau)(plateK.south east) (plateN.south east) (plateN.north east) (plateG.south east)} {$D_m$};
  \plate[] {plateM} {(plateK.north east)(plateD.south east)(plateD.south west)(plateG.north east)} {$M$};
\end{tikzpicture}
